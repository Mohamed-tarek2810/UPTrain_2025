@model UPTrain.Models.Quiz
@{
    ViewData["Title"] = "Quiz Result";
}

<div class="container mt-5">
    <div class="card shadow-lg border-0 rounded-3">
        <div class="card-header bg-success text-white text-center">
            <h3>@Model.Title - Result</h3>
        </div>
        <div class="card-body">
            <h4 class="text-center text-primary">Your Score</h4>
            <p class="text-center fs-5">
                Correct Answers: <strong>@ViewBag.CorrectAnswers</strong> /
                <strong>@ViewBag.TotalQuestions</strong>
            </p>
            <p class="text-center fs-4 fw-bold text-dark">
                Percentage: <span class="text-success">@ViewBag.Percentage %</span>
            </p>

       
            @if (ViewBag.Percentage >= 75)
            {
                <div class="text-center mt-4">
                    <a asp-area="Customer" asp-controller="Lesson" asp-action="Certificate" class="btn btn-lg btn-warning fw-bold">
                        🎓 Your Certificate
                    </a>
                </div>
            }

            <hr />
            <h5>Review Questions:</h5>
            <ol class="list-group list-group-numbered">
                @foreach (var question in ViewBag.Questions)
                {
                    var userAnswer = ViewBag.UserAnswers.ContainsKey(question.QuestionId)
                    ? ViewBag.UserAnswers[question.QuestionId]
                    : "No Answer";

                    string correctAnswerText = question.CorrectAnswer switch
                    {
                        AnswerOption.A => question.OptionA,
                        AnswerOption.B => question.OptionB,
                        AnswerOption.C => question.OptionC,
                        AnswerOption.D => question.OptionD,
                        _ => "N/A"
                    };

                    <li class="list-group-item">
                        <p><strong>@question.QuestionText</strong></p>
                        <p>
                            Correct Answer:
                            <span class="text-success fw-bold">@correctAnswerText</span>
                        </p>
                    </li>
                }
            </ol>
        </div>
    </div>
</div>
